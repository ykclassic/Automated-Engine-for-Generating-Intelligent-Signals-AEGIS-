# AEGIS Deployment Configuration for Render.com

services:
  - type: web
    name: aegis-dashboard
    runtime: python
    buildCommand: "pip install -r requirements.txt"
    startCommand: "streamlit run dashboard/app.py --server.port $PORT --server.headless true"
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: STREAMLIT_SERVER_MAX_UPLOAD_SIZE
        value: 50
      - key: AEGIS_ENV
        value: production
    
    # Auto-deploy from GitHub
    autoDeploy: true
    
    # Health check
    healthCheckPath: /_stcore/health

  - type: cron
    name: aegis-data-pipeline
    runtime: python
    buildCommand: "pip install -r requirements.txt"
    schedule: "*/5 * * * *"
    startCommand: "python -c 'from src.core.data_fetcher import update_all_data; update_all_data()'"
    
  - type: cron
    name: aegis-signal-generator
    runtime: python
    buildCommand: "pip install -r requirements.txt"
    schedule: "*/5 * * * *"
    startCommand: "python src/core/signal_generator.py"
    
  - type: cron
    name: aegis-model-trainer
    runtime: python
    buildCommand: "pip install -r requirements.txt"
    schedule: "0 0 * * 0"  # Weekly
    startCommand: "python src/ml/train.py"
